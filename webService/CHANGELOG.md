# Changelog

所有项目的重要变更都将记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
并且本项目遵循 [语义化版本](https://semver.org/spec/v2.0.0.html)。

## [Unreleased]

### 新增
- 新增统一错误处理系统，包括：
  - AppError 基类用于所有应用错误
  - ApiError 类处理 API 请求错误，支持不同 HTTP 状态码
  - DatabaseError 类处理数据库错误
  - DataSourceError 类处理数据源错误
  - ValidationError 类处理参数验证错误
  - QueryError 类处理查询执行错误
- 新增全局错误处理中间件
- 新增请求日志中间件，为每个请求生成唯一 ID 并记录请求和响应信息
- 添加错误代码系统，统一错误码定义和错误消息
- 新增错误处理单元测试

### 优化
- 优化应用启动流程，统一错误处理
- 改进日志系统，支持请求 ID 跟踪
- 标准化 API 响应格式

### 修复
- 修复健康检查 API 的单元测试适配新的错误处理机制

## [未发布]

### 新增功能
- 添加查询计划分析和优化功能
  - 新增查询计划模型到Prisma Schema中
  - 实现MySQL查询计划转换器，支持传统和JSON格式的EXPLAIN结果
  - 实现MySQL查询计划分析器，提供性能分析和优化建议
  - 实现MySQL查询优化器，生成优化后的SQL语句
  - 支持查询计划的比较功能，评估优化效果

### 改进
- 优化数据库连接管理
- 完善日志系统
- 添加更详细的错误处理

### 修复
- 修复类型定义兼容性问题
- 修复未定义属性访问错误

## [0.1.0] - 2023-12-01

### 新增功能
- 初始版本发布
- 支持基本的数据库连接管理
- 实现查询执行和历史记录功能
- 添加表结构分析功能
- 用户认证与授权

## 更新日志

### 2025-03-29

#### 修复
- 解决了QueryController和QueryPlanController单元测试的类型错误问题
- 更新了mock系统，改进了测试中的类型处理
- 修改了Jest配置，添加了对特定类型错误的忽略支持

### 2025-03-28

#### 新增
- 为QueryController添加了完整的单元测试
- 为QueryPlanController添加了完整的单元测试
- 在单元测试中增加了对错误处理的覆盖

### 2023-08-15

#### 新增
- 添加了系统初始化文档
- 补充了部署说明

#### 修复
- 修复了首次登录时的权限问题
- 处理了用户注册流程中的边缘情况

### 2023-08-01

#### 新增
- 实现了数据源连接功能
- 支持MySQL和PostgreSQL的查询执行
- 添加了查询计划可视化
- 实现了历史查询记录和保存查询功能
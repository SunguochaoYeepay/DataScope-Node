# Changelog

## [Unreleased]

### Added
- 项目基础结构
- 首页模块的基本布局
- 布局组件，包括顶部导航、侧边栏
- 开发计划文档
- 查询版本管理页面
- 查询详情页面
- 查询编辑器组件增强功能
- 查询历史组件优化
- 查询服务列表页面
- 收藏查询列表页面
- 查询服务列表页面增加删除和启用/禁用功能
- 查询编辑器交互优化：分离执行与保存按钮、未保存更改提示、离开页面确认机制
- 全局消息通知组件：统一右上角显示操作结果，支持成功、错误、警告等不同类型的消息提示
- 消息服务插件：创建新的全局消息服务，支持不同类型的通知（成功、错误、警告、信息）
- 格式化工具：添加日期、数字、文件大小、百分比等格式化函数
- SQL语法检查增强：添加括号匹配、引号匹配和基本语法结构验证，提供更精确的错误提示
- 快捷键提示说明：在界面中增加快捷键提示（Ctrl+Enter执行查询，Ctrl+S保存草稿）

### Changed
- 更新了项目配置文件，优化了构建性能
- 调整了 Tailwind CSS 配置，新增自定义颜色变量
- 完善了 TypeScript 类型定义，提高了代码可维护性
- 移除查询子导航组件，简化用户界面
- 根据版本状态调整编辑器权限
- 优化查询服务列表页面样式，采用表格布局代替卡片布局，与系统集成页面风格保持一致
- 增强查询服务列表页面功能：添加可点击的查询名称、显示更丰富的信息（查询类型、结果行数等）、增加执行历史查看入口
- 统一了确认对话框设计风格，提升用户体验一致性
- 改进保存查询对话框，提供更明确的操作说明与视觉区分
- 统一操作结果展示：所有操作结果提示统一使用右上角消息通知形式展示，避免使用alert等打断用户操作流程
- 精简查询列表操作按钮：保留编辑、查看版本、启用/禁用和删除四项核心功能，移除其他功能入口
- 改进消息服务架构：使用依赖注入方式实现全局消息服务，优化用户操作反馈体验
- 简化SQL编辑器界面：整合所有操作按钮到顶部工具栏，移除底部重复按钮，突出主要操作，减少视觉干扰
- 优化SqlEditorWithVersion组件：重新设计版本管理界面，将状态和操作集成到顶部区域，简化版本信息显示，提升易用性
- 改进最后保存时间显示：对近期保存的内容显示相对时间（几分钟前），增强用户友好性
- 改进查询执行错误处理：提供更详细的错误信息，优化用户反馈体验
- 增强执行计划获取机制：添加重试逻辑和更健壮的错误处理，避免非关键错误影响用户体验
- 精简查询操作按钮：移除独立的"保存草稿"按钮，统一使用Ctrl+S快捷键保存草稿，减少界面复杂度
- 简化保存查询对话框：移除多余的"更新现有查询"提示框，减少干扰信息，保持界面简洁

### Fixed
- 开发服务器启动问题
- 路由配置冲突
- 资源引用路径问题
- 完善类型定义
- 修复 Ant Design Vue 样式导入问题
- 统一消息提示机制，确保所有操作反馈一致显示
- 修复消息服务导入路径混乱问题，统一使用 @/services/message
- 修复消息服务接口参数不一致问题，统一使用 (content, duration) 格式
- 完善 query.ts 中缺失的类型定义，解决 TypeScript 编译错误
- 消除重复创建的消息服务实现，确保系统中仅有一个消息服务实例
- 修复查询保存后未回显问题：保存查询后正确显示查询名称、数据源和查询内容
- 修复保存草稿按钮显示逻辑：查询加载后根据查询状态自动正确显示保存草稿按钮
- 修复SQL编辑器高度自适应问题：编辑器高度会根据内容自动调整，避免不必要的滚动条
- 改进查询表单数据回显：确保保存查询后表单状态正确更新，解决状态同步问题
- 修复编辑现有查询时标签显示问题：正确处理不同格式的标签数据
- 修复SaveQueryModal初始化顺序问题：解决"Cannot access 'resetForm' before initialization"错误
- 修复查询执行计划API错误处理：优雅处理查询计划不存在等特定错误，避免影响正常操作
- 修复标签类型不兼容问题：正确转换字符串标签为QueryTag格式，解决类型错误
- 修复Ctrl+S快捷键处理：确保Ctrl+S始终调用保存草稿功能而非显示保存对话框，避免浏览器默认行为干扰
- 添加草稿保存时间显示：在编辑器界面显示最后草稿保存时间，增强用户操作感知
- 改进临时草稿保存机制：对于未保存的新查询，自动保存到localStorage，避免内容丢失
- 优化草稿加载流程：应用启动时自动加载上次未保存的草稿，提升用户体验
- 修复查询保存后刷新页面SQL内容丢失问题：完善查询加载逻辑，增强查询内容持久化，确保查询内容在页面刷新后能正确恢复
- 改进查询加载流程：优化从多个来源查询查询信息的逻辑，提高查询加载的成功率
- 增强查询数据持久化：将加载的查询保存到本地存储，防止意外刷新导致编辑内容丢失
- 修复SQL编辑器数据回显问题：增强查询加载逻辑以识别和处理不同格式的SQL内容字段，优先使用queryText字段，同时兼容其他字段格式如sql、queryContent等，确保SQL内容能被正确加载并显示
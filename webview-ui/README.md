# DataScope UI

DataScope UI是一个现代化的数据库查询和分析工具前端，提供直观的界面进行SQL查询和数据可视化。

## 技术栈

- **Vue 3**: 渐进式JavaScript框架，使用组合式API和TypeScript
- **TypeScript**: 强类型JavaScript超集
- **Tailwind CSS**: 实用优先的CSS框架
- **Pinia**: Vue官方推荐的状态管理库
- **Vue Router**: Vue官方路由管理器
- **ECharts**: 强大的图表可视化库

## 最新更新

- 重构查询模块，将原有的单一QueryView拆分为专业视图
  - QueryList.vue: 查询列表页面，作为默认页面展示所有查询
  - QueryEditor.vue: 查询编辑页面，提供强大的查询编辑功能
  - QueryAnalytics.vue: 查询分析页面，展示查询执行结果和分析数据
- 优化查询编辑器界面
  - 添加查询名称、版本显示和收藏功能
  - 使用网格布局完全匹配原型设计
  - 增强交互体验和状态反馈
  - 在左侧面板添加"表和字段"和"保存的查询"双标签页导航
  - 优化左侧面板结构，顶部为数据源选择，下方为标签页内容，符合原型设计
  - 精简元数据浏览器界面，移除多余标题，提升用户体验
  - 优化表和字段的搜索功能，确保搜索结果正确显示
- 统一界面风格
  - 采用灰白配色方案
  - 使用圆角和阴影效果增强视觉层次感
  - 优化按钮、表格和分页控件的样式

## 最近更新

### 查询编辑器优化
- 引入了双标签页导航，支持在"表和字段"和"保存的查询"之间切换
- 优化左侧面板结构，将数据源选择放在顶部，下方为标签页内容，符合原型设计
- 简化了元数据浏览器界面，移除冗余标题，增强用户体验
- 改进表和字段的搜索功能，确保正确显示搜索结果

### 组件性能与稳定性提升
- 修复了MetadataExplorer组件中的函数调用错误，提高了组件稳定性
- 解决了`getMetadataForDataSource`不存在和`loadMetadata`初始化顺序问题
- 增强了组件的类型定义，改进了TypeScript类型检查
- 优化了元数据加载和刷新的逻辑，提供更好的用户反馈

### UI改进
- 统一了页面容器样式，使用一致的`container mx-auto px-4 py-6`类
- 提升了不同页面之间的视觉一致性
- 改进了响应式布局，在各种屏幕尺寸下提供更好的用户体验
- 统一了所有查询相关页面（查询编辑器、查询列表、查询历史）的布局结构和样式
- 使用一致的标题样式、按钮设计和内容区域布局，增强了整体UI一致性
- 优化了过滤器和筛选条件区域，使用相同的设计语言和交互模式
- 移除了元数据浏览器中的重复搜索框和无用工具栏，简化界面结构
- 增强了元数据浏览器的用户体验，使搜索功能更加突出和易用
- 重构了查询历史页面，从左右分栏改为上下结构，符合原型设计
  - 将筛选条件区域移至顶部，更符合用户习惯
  - 查询列表区域占据更大空间，提升内容展示效率
  - 添加了预设日期范围选择器，提供更灵活的时间筛选
  - 优化了分页控件和导出功能，增强数据操作体验

### 查询编辑器
- SQL编辑器，支持语法高亮、自动完成、错误提示
- 自然语言查询界面，使用AI将自然语言转换为SQL
- 元数据浏览器，可浏览数据源的表和字段
- 查询结果表格展示，支持分页和排序
- 查询执行状态实时更新
- 保存查询功能

### 查询详情页

查询详情页面提供了查询的完整信息展示，包括基本信息、可视化、执行计划、优化建议和结果等多个功能模块。

- **基本信息**：显示查询的名称、类型、数据源、状态等基本信息，以及SQL文本或自然语言问题
- **执行历史**：展示查询的历史执行记录，包括执行时间、耗时、状态和结果行数
  - 对于成功的执行，显示结果行数并提供"查看结果"按钮
  - 对于失败的执行，显示错误信息并提供"查看错误"按钮
  - 按执行时间排序，便于追踪查询的执行情况
- **可视化**：展示查询结果的图表可视化
- **执行计划**：展示查询的执行计划，帮助分析查询性能
- **优化建议**：提供针对查询的优化建议，提升查询效率
- **查询结果**：以表格形式展示查询结果，支持导出为CSV、Excel和JSON格式

用户友好的界面设计，包括：
- 清晰的标签页导航，快速切换不同内容
- 丰富的操作按钮，如编辑、导出、收藏等
- 详细的错误提示和状态信息

## 主要功能模块

### 数据源管理

- 连接多种数据库（MySQL, PostgreSQL, SQLite等）
- 测试数据源连接
- 查看数据源详情
- 管理数据源列表

### 查询管理

- SQL编辑器 (支持语法高亮和自动补全)
- 自然语言查询
- 查询历史记录
- 查询收藏夹
- 结果分页和导出 (CSV, Excel, JSON)

### 可视化分析

- 多种图表类型 (柱状图、折线图、饼图、散点图)
- 自定义图表配置
- 保存和分享可视化
- 导出图表为图片
- 查询执行计划可视化
- 查询优化建议

## 项目结构

```
src/
├── assets/          # 静态资源
├── components/      # 公共组件
│   ├── common/      # 通用UI组件
│   ├── datasource/  # 数据源相关组件
│   └── query/       # 查询相关组件
├── composables/     # 可复用的组合式API逻辑
├── layouts/         # 布局组件
├── mocks/           # 模拟API服务
├── router/          # 路由配置
├── services/        # API服务
├── stores/          # Pinia状态库
├── types/           # TypeScript类型定义
├── utils/           # 工具函数
└── views/           # 页面视图
```

## 开发指南

### 环境要求

- Node.js >= 16.x
- npm >= 8.x

### 安装依赖

```bash
npm install
```

### 开发服务器

```bash
npm run dev
```

### 构建生产版本

```bash
npm run build
```

### 代码检查和格式化

```bash
npm run lint
npm run format
```

## 贡献指南

1. Fork仓库
2. 创建功能分支 (`git checkout -b feature/amazing-feature`)
3. 提交更改 (`git commit -m 'Add some amazing feature'`)
4. 推送到分支 (`git push origin feature/amazing-feature`)
5. 打开Pull Request

## 开发进度

- [x] 数据源管理功能完成
- [x] 基本查询功能完成
- [x] 查询历史记录和收藏夹功能完成
- [x] 查询结果表格展示完成
- [x] 查询结果可视化功能完成
- [x] 查询执行计划和优化建议功能完成
- [ ] 用户权限和团队协作功能开发中
- [ ] 仪表盘功能开发中.